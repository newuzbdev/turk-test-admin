import{r as h,s as ne,t as Q,v as ae,w as Y,x as W,_ as te,K as V,y as ie,z as se,A as re,D as j,E as le,G as ce,H as oe,J as de,L as he,W as ue,N as ge,O as me,P as B,h as N,f as U,g as L,V as A,j as t,Q as pe,T as ye,S as _,B as v,e as xe,m as Se,n as G,F as $,U as fe,M as Ce,d as D,X as ke,Y as ve,Z as $e,$ as z,a0 as X,a1 as we,a2 as J,l as Ie,q as be,a3 as je}from"./index-9PL95cny.js";import{R as Be}from"./ReloadOutlined-BaECXpbv.js";var Me=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],Z=h.forwardRef(function(e,n){var a,i=e.prefixCls,l=i===void 0?"rc-switch":i,o=e.className,d=e.checked,s=e.defaultChecked,r=e.disabled,c=e.loadingIcon,u=e.checkedChildren,m=e.unCheckedChildren,f=e.onClick,y=e.onChange,C=e.onKeyDown,w=ne(e,Me),M=Q(!1,{value:d,defaultValue:s}),I=ae(M,2),x=I[0],g=I[1];function E(S,q){var b=x;return r||(b=S,g(b),y?.(b,q)),b}function R(S){S.which===V.LEFT?E(!1,S):S.which===V.RIGHT&&E(!0,S),C?.(S)}function k(S){var q=E(!x,S);f?.(q,S)}var P=Y(l,o,(a={},W(a,"".concat(l,"-checked"),x),W(a,"".concat(l,"-disabled"),r),a));return h.createElement("button",te({},w,{type:"button",role:"switch","aria-checked":x,disabled:r,className:P,ref:n,onKeyDown:R,onClick:k}),c,h.createElement("span",{className:"".concat(l,"-inner")},h.createElement("span",{className:"".concat(l,"-inner-checked")},u),h.createElement("span",{className:"".concat(l,"-inner-unchecked")},m)))});Z.displayName="Switch";const Ee=e=>{const{componentCls:n,trackHeightSM:a,trackPadding:i,trackMinWidthSM:l,innerMinMarginSM:o,innerMaxMarginSM:d,handleSizeSM:s,calc:r}=e,c=`${n}-inner`,u=j(r(s).add(r(i).mul(2)).equal()),m=j(r(d).mul(2).equal());return{[n]:{[`&${n}-small`]:{minWidth:l,height:a,lineHeight:j(a),[`${n}-inner`]:{paddingInlineStart:d,paddingInlineEnd:o,[`${c}-checked, ${c}-unchecked`]:{minHeight:a},[`${c}-checked`]:{marginInlineStart:`calc(-100% + ${u} - ${m})`,marginInlineEnd:`calc(100% - ${u} + ${m})`},[`${c}-unchecked`]:{marginTop:r(a).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${n}-handle`]:{width:s,height:s},[`${n}-loading-icon`]:{top:r(r(s).sub(e.switchLoadingIconSize)).div(2).equal(),fontSize:e.switchLoadingIconSize},[`&${n}-checked`]:{[`${n}-inner`]:{paddingInlineStart:o,paddingInlineEnd:d,[`${c}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${c}-unchecked`]:{marginInlineStart:`calc(100% - ${u} + ${m})`,marginInlineEnd:`calc(-100% + ${u} - ${m})`}},[`${n}-handle`]:{insetInlineStart:`calc(100% - ${j(r(s).add(i).equal())})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${c}`]:{[`${c}-unchecked`]:{marginInlineStart:r(e.marginXXS).div(2).equal(),marginInlineEnd:r(e.marginXXS).mul(-1).div(2).equal()}},[`&${n}-checked ${c}`]:{[`${c}-checked`]:{marginInlineStart:r(e.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:r(e.marginXXS).div(2).equal()}}}}}}},qe=e=>{const{componentCls:n,handleSize:a,calc:i}=e;return{[n]:{[`${n}-loading-icon${e.iconCls}`]:{position:"relative",top:i(i(a).sub(e.fontSize)).div(2).equal(),color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${n}-checked ${n}-loading-icon`]:{color:e.switchColor}}}},Te=e=>{const{componentCls:n,trackPadding:a,handleBg:i,handleShadow:l,handleSize:o,calc:d}=e,s=`${n}-handle`;return{[n]:{[s]:{position:"absolute",top:a,insetInlineStart:a,width:o,height:o,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:i,borderRadius:d(o).div(2).equal(),boxShadow:l,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${n}-checked ${s}`]:{insetInlineStart:`calc(100% - ${j(d(o).add(a).equal())})`},[`&:not(${n}-disabled):active`]:{[`${s}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${n}-checked ${s}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},ze=e=>{const{componentCls:n,trackHeight:a,trackPadding:i,innerMinMargin:l,innerMaxMargin:o,handleSize:d,calc:s}=e,r=`${n}-inner`,c=j(s(d).add(s(i).mul(2)).equal()),u=j(s(o).mul(2).equal());return{[n]:{[r]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:o,paddingInlineEnd:l,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${r}-checked, ${r}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:a},[`${r}-checked`]:{marginInlineStart:`calc(-100% + ${c} - ${u})`,marginInlineEnd:`calc(100% - ${c} + ${u})`},[`${r}-unchecked`]:{marginTop:s(a).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${n}-checked ${r}`]:{paddingInlineStart:l,paddingInlineEnd:o,[`${r}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${r}-unchecked`]:{marginInlineStart:`calc(100% - ${c} + ${u})`,marginInlineEnd:`calc(-100% + ${c} - ${u})`}},[`&:not(${n}-disabled):active`]:{[`&:not(${n}-checked) ${r}`]:{[`${r}-unchecked`]:{marginInlineStart:s(i).mul(2).equal(),marginInlineEnd:s(i).mul(-1).mul(2).equal()}},[`&${n}-checked ${r}`]:{[`${r}-checked`]:{marginInlineStart:s(i).mul(-1).mul(2).equal(),marginInlineEnd:s(i).mul(2).equal()}}}}}},Ae=e=>{const{componentCls:n,trackHeight:a,trackMinWidth:i}=e;return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},re(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:i,height:a,lineHeight:j(a),verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${n}-disabled)`]:{background:e.colorTextTertiary}}),le(e)),{[`&${n}-checked`]:{background:e.switchColor,[`&:hover:not(${n}-disabled)`]:{background:e.colorPrimaryHover}},[`&${n}-loading, &${n}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${n}-rtl`]:{direction:"rtl"}})}},Re=e=>{const{fontSize:n,lineHeight:a,controlHeight:i,colorWhite:l}=e,o=n*a,d=i/2,s=2,r=o-s*2,c=d-s*2;return{trackHeight:o,trackHeightSM:d,trackMinWidth:r*2+s*4,trackMinWidthSM:c*2+s*2,trackPadding:s,handleBg:l,handleSize:r,handleSizeSM:c,handleShadow:`0 2px 4px 0 ${new ce("#00230b").setA(.2).toRgbString()}`,innerMinMargin:r/2,innerMaxMargin:r+s+s*2,innerMinMarginSM:c/2,innerMaxMarginSM:c+s+s*2}},Pe=ie("Switch",e=>{const n=se(e,{switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchLoadingIconSize:e.calc(e.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[Ae(n),ze(n),Te(n),qe(n),Ee(n)]},Re);var De=function(e,n){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.indexOf(i)<0&&(a[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(e);l<i.length;l++)n.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(e,i[l])&&(a[i[l]]=e[i[l]]);return a};const Ne=h.forwardRef((e,n)=>{const{prefixCls:a,size:i,disabled:l,loading:o,className:d,rootClassName:s,style:r,checked:c,value:u,defaultChecked:m,defaultValue:f,onChange:y}=e,C=De(e,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[w,M]=Q(!1,{value:c??u,defaultValue:m??f}),{getPrefixCls:I,direction:x,switch:g}=h.useContext(oe),E=h.useContext(de),R=(l??E)||o,k=I("switch",a),P=h.createElement("div",{className:`${k}-handle`},o&&h.createElement(ge,{className:`${k}-loading-icon`})),[S,q,b]=Pe(k),F=he(i),p=Y(g?.className,{[`${k}-small`]:F==="small",[`${k}-loading`]:o,[`${k}-rtl`]:x==="rtl"},d,s,q,b),T=Object.assign(Object.assign({},g?.style),r),H=(...K)=>{M(K[0]),y?.apply(void 0,K)};return S(h.createElement(ue,{component:"Switch"},h.createElement(Z,Object.assign({},C,{checked:w,onChange:H,prefixCls:k,className:p,style:T,disabled:R,ref:n,loadingIcon:P}))))}),ee=Ne;ee.__ANT_SWITCH=!0;const Fe=()=>me({queryKey:[B.all],queryFn:async()=>{try{const e=await N.get(B.all);return console.log("Raw API response:",e),console.log("Response data:",e.data),e.data}catch(e){throw console.error("API Error:",e),e}}}),He=()=>{const e=U();return L({mutationFn:async n=>(await N.post(B.all,n)).data,onSuccess:()=>{e.invalidateQueries({queryKey:[B.all]}),A.success("Banner muvaffaqiyatli yaratildi")},onError:n=>{console.error("Banner creation error:",n);const a=n?.response?.data?.error||"Banner yaratishda xatolik yuz berdi";A.error(a)}})},Oe=()=>{const e=U();return L({mutationFn:async n=>{const{id:a,...i}=n;return(await N.patch(B.one(a),i)).data},onSuccess:()=>{e.invalidateQueries({queryKey:[B.all]}),A.success("Banner muvaffaqiyatli yangilandi")},onError:n=>{console.error("Banner update error:",n);const a=n?.response?.data?.error||"Banner yangilashda xatolik yuz berdi";A.error(a)}})},Ue=()=>{const e=U();return L({mutationFn:async n=>(await N.delete(B.one(n))).data,onSuccess:()=>{e.invalidateQueries({queryKey:[B.all]}),A.success("Banner muvaffaqiyatli o'chirildi")},onError:n=>{console.error("Banner deletion error:",n);const a=n?.response?.data?.error||"Banner o'chirishda xatolik yuz berdi";A.error(a)}})},Le="https://api.turkcetest.uz/",Ke=({onEdit:e,onDelete:n})=>[{title:"Rasm",dataIndex:"imageUrl",key:"imageUrl",width:100,render:a=>t.jsx(pe,{src:Le+a,alt:"Banner",width:60,height:40,style:{objectFit:"cover",borderRadius:4}})},{title:"Nomi",dataIndex:"name",key:"name",ellipsis:!0},{title:"Sarlavha",dataIndex:"title",key:"title",ellipsis:!0},{title:"Tavsif",dataIndex:"description",key:"description",ellipsis:!0,render:a=>a||"-"},{title:"Link",dataIndex:"linkUrl",key:"linkUrl",ellipsis:!0,render:a=>a||"-"},{title:"Tartib",dataIndex:"order",key:"order",width:80,sorter:(a,i)=>(a.order||0)-(i.order||0)},{title:"Holat",dataIndex:"isActive",key:"isActive",width:100,render:a=>t.jsx(ye,{color:a?"green":"red",children:a?"Faol":"Nofaol"})},{title:"Amallar",key:"actions",width:150,render:(a,i)=>t.jsxs(_,{size:"small",children:[t.jsx(v,{type:"text",icon:t.jsx(xe,{}),size:"small",title:"Ko'rish"}),t.jsx(v,{type:"text",icon:t.jsx(Se,{}),size:"small",title:"Tahrirlash",onClick:()=>e(i)}),t.jsx(v,{type:"text",danger:!0,icon:t.jsx(G,{}),size:"small",title:"O'chirish",onClick:()=>n(i.id)})]})}],{TextArea:We}=D,Ve="https://api.turkcetest.uz/";function Xe({open:e,onClose:n,banner:a,mode:i}){const[l]=$.useForm(),[o,d]=h.useState(""),[s,r]=h.useState(!1),{mutate:c,isPending:u}=He(),{mutate:m,isPending:f}=Oe(),y=fe(),C=u||f;h.useEffect(()=>{e&&(i==="edit"&&a?(l.setFieldsValue({name:a.name,title:a.title,description:a.description,linkUrl:a.linkUrl,isActive:a.isActive??!0,order:a.order??1}),d(a.imageUrl)):(l.resetFields(),d("")))},[e,i,a,l]);const w=async x=>{try{r(!0);const g=await y.mutateAsync(x);g?.path&&(d(g.path),z.success("Rasm yuklandi"))}catch{z.error("Rasm yuklashda xatolik")}finally{r(!1)}return!1},M=async x=>{if(!o){z.error("Rasm yuklash kerak");return}const g={...x,imageUrl:o};i==="create"?c(g,{onSuccess:()=>{l.resetFields(),d(""),n()}}):i==="edit"&&a?.id&&m({id:a.id,...g},{onSuccess:()=>{n()}})},I=()=>{l.resetFields(),d(""),n()};return t.jsx(Ce,{title:i==="create"?"Yangi Banner Yaratish":"Banner Tahrirlash",open:e,onCancel:I,footer:null,width:600,destroyOnClose:!0,children:t.jsxs($,{form:l,layout:"vertical",onFinish:M,initialValues:{isActive:!0,order:1},children:[t.jsx($.Item,{name:"name",label:"Nomi",rules:[{required:!0,message:"Nomi kiritish kerak"}],children:t.jsx(D,{placeholder:"Masalan: Summer Sale"})}),t.jsx($.Item,{name:"title",label:"Sarlavha",rules:[{required:!0,message:"Sarlavha kiritish kerak"}],children:t.jsx(D,{placeholder:"Masalan: Big Discounts"})}),t.jsx($.Item,{name:"description",label:"Tavsif",children:t.jsx(We,{rows:3,placeholder:"Banner haqida qisqacha ma'lumot..."})}),t.jsx($.Item,{name:"linkUrl",label:"Havola URL",children:t.jsx(D,{placeholder:"https://example.com"})}),t.jsx($.Item,{label:"Rasm",required:!0,children:t.jsxs("div",{children:[t.jsx(ke,{showUploadList:!1,accept:"image/*",beforeUpload:w,children:t.jsx(v,{icon:t.jsx(ve,{}),loading:s,disabled:C,children:s?"Yuklanmoqda...":"Rasm yuklash"})}),o&&t.jsxs("div",{style:{marginTop:8},children:[t.jsx("img",{src:Ve+o,alt:"Preview",style:{width:"100%",maxHeight:200,objectFit:"contain",borderRadius:4,border:"1px solid #d9d9d9"}}),t.jsx(v,{type:"text",danger:!0,icon:t.jsx(G,{}),onClick:()=>d(""),style:{marginTop:4},children:"O'chirish"})]})]})}),t.jsxs("div",{style:{display:"flex",gap:16},children:[t.jsx($.Item,{name:"isActive",label:"Faol",valuePropName:"checked",style:{flex:1},children:t.jsx(ee,{})}),t.jsx($.Item,{name:"order",label:"Tartib",style:{flex:1},children:t.jsx($e,{min:1,max:999,style:{width:"100%"}})})]}),t.jsx($.Item,{style:{marginBottom:0,marginTop:24},children:t.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[t.jsx(v,{onClick:I,disabled:C,children:"Bekor qilish"}),t.jsx(v,{type:"primary",htmlType:"submit",loading:C,disabled:!o,children:i==="create"?"Yaratish":"Yangilash"})]})})]})})}const{Search:Qe}=D,{Option:O}=J;function Ye(){const[e,n]=h.useState(""),[a,i]=h.useState("all"),[l,o]=h.useState([]),[d,s]=h.useState(!1),[r,c]=h.useState("create"),[u,m]=h.useState(null),{data:f,isLoading:y,refetch:C,error:w}=Fe(),{mutate:M,isPending:I}=Ue(),x=Array.isArray(f?.data)?f.data:Array.isArray(f)?f:[],g=[{id:"1",name:"Summer Sale",title:"Test Banner 1",description:"Test description",imageUrl:"test-image.jpg",linkUrl:"https://example.com",isActive:!0,order:1,createdAt:"2024-01-01",updatedAt:"2024-01-01"},{id:"2",name:"Winter Sale",title:"Test Banner 2",description:"Another test description",imageUrl:"test-image2.jpg",linkUrl:"https://example2.com",isActive:!1,order:2,createdAt:"2024-01-02",updatedAt:"2024-01-02"}],E=x.length>0?x:g;console.log("Banner data:",f),console.log("Banners array:",x),console.log("Loading:",y),console.log("Error:",w);const R=E.filter(p=>{const T=p.title.toLowerCase().includes(e.toLowerCase())||p.description&&p.description.toLowerCase().includes(e.toLowerCase()),H=a==="all"||a==="active"&&p.isActive||a==="inactive"&&!p.isActive;return T&&H}),k=()=>{c("create"),m(null),s(!0)},P=p=>{c("edit"),m(p),s(!0)},S=p=>{M(p,{onSuccess:()=>{z.success("Banner o'chirildi")}})},q=()=>{if(l.length===0){z.warning("O'chirish uchun banner tanlang");return}z.info("Bulk delete functionality to be implemented")},b={selectedRowKeys:l,onChange:o},F=Ke({onEdit:P,onDelete:S});return w?t.jsx(X,{children:t.jsxs("div",{style:{textAlign:"center",padding:"50px 0"},children:[t.jsx("h3",{children:"Xatolik yuz berdi"}),t.jsxs("p",{children:["Bannerlarni yuklashda xatolik: ",w.message]}),t.jsx(v,{type:"primary",onClick:()=>C(),children:"Qayta urinish"})]})}):t.jsxs(X,{children:[t.jsx("div",{style:{marginBottom:16},children:t.jsxs(_,{wrap:!0,children:[t.jsx(Qe,{placeholder:"Banner qidirish...",value:e,onChange:p=>n(p.target.value),style:{width:300},prefix:t.jsx(we,{})}),t.jsxs(J,{value:a,onChange:i,style:{width:120},children:[t.jsx(O,{value:"all",children:"Barchasi"}),t.jsx(O,{value:"active",children:"Faol"}),t.jsx(O,{value:"inactive",children:"Nofaol"})]}),t.jsx(v,{type:"primary",icon:t.jsx(Ie,{}),onClick:k,children:"Yangi Banner"}),t.jsx(v,{icon:t.jsx(Be,{}),onClick:()=>C(),loading:y,children:"Yangilash"}),l.length>0&&t.jsxs(v,{danger:!0,onClick:q,loading:I,children:["Tanlanganlarni o'chirish (",l.length,")"]})]})}),t.jsx(be,{columns:F,dataSource:R,rowKey:"id",loading:y,rowSelection:b,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(p,T)=>`${T[0]}-${T[1]} / ${p} ta banner`},scroll:{x:800},locale:{emptyText:y?"Yuklanmoqda...":"Bannerlar topilmadi"}}),t.jsx(Xe,{open:d,onClose:()=>s(!1),banner:u,mode:r})]})}const{Title:_e}=je;function Ze(){return t.jsxs("div",{style:{padding:24},children:[t.jsx(_e,{level:2,style:{marginBottom:24},children:"Banner Boshqaruvi"}),t.jsx(Ye,{})]})}export{Ze as default};

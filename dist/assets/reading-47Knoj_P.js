import{j as e,T as R,B as p,r as u,L as y,R as N,M as B,a as W}from"./index-uUpZomyQ.js";import{u as U,a as _,b as H,c as K}from"./test-query-XPHuE7MP.js";import{B as Q,S as J,R as M,a as D,b as V}from"./section-form-D4rxT0OD.js";import{C as w,R as P,S as z,a as $,b as E,F as X}from"./Table-XGYKetWf.js";import{R as q,C as T}from"./row-B70nMuzF.js";import{I as A}from"./index-VUfoB9ds.js";import{u as Z}from"./Ielts-query-BGPdEFI_.js";const{Title:ee,Text:L}=R;function te({part:a,onChange:h,onRemove:m}){const r=(t,o)=>{const d=[...a.sections];d[t]=o,h({...a,sections:d})},l=()=>{const t={title:"",content:"",imageUrl:"",questions:[]};h({...a,sections:[...a.sections,t]})},s=t=>{const o=a.sections.filter((d,f)=>f!==t);h({...a,sections:o})};return e.jsxs(w,{style:{marginBottom:32,borderRadius:"16px",border:"2px solid #f0f9ff",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",overflow:"hidden"},children:[e.jsx("div",{style:{background:"linear-gradient(135deg, #4f46e5 0%, #4338ca 100%)",margin:"-24px -24px 24px -24px",padding:"20px 24px",color:"white"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px"},children:"📖"}),e.jsxs("div",{children:[e.jsxs(ee,{level:4,style:{margin:0,color:"white"},children:["Part ",a.number]}),e.jsxs(L,{style:{color:"rgba(255,255,255,0.8)",fontSize:"12px"},children:[a.sections.length," ta bo'lim"]})]})]}),e.jsx(p,{danger:!0,type:"text",icon:e.jsx(P,{}),onClick:m,style:{color:"rgba(255,255,255,0.9)",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px"},children:"O'chirish"})]})}),e.jsx(q,{gutter:[20,20],style:{marginBottom:"28px"},children:e.jsxs(T,{span:24,children:[e.jsx("div",{style:{marginBottom:"8px"},children:e.jsx("label",{style:{fontWeight:600,fontSize:"14px"},children:"📘 Part sarlavhasi"})}),e.jsx(A,{placeholder:"Masalan: Akademik maqola",value:a.title,onChange:t=>h({...a,title:t.target.value}),size:"large"})]})}),e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",border:"1px solid #f0f0f0"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(L,{strong:!0,style:{color:"#374151",fontSize:"16px"},children:"📚 Bo'limlar"}),e.jsx(Q,{count:a.sections.length,style:{background:"#6366f1",color:"white",fontSize:"11px"}})]}),e.jsxs(z,{direction:"vertical",style:{width:"100%"},size:"middle",children:[a.sections.map((t,o)=>e.jsx("div",{style:{background:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0",overflow:"hidden"},children:e.jsx(J,{section:t,onChange:d=>r(o,d),onRemove:()=>s(o)})},o)),e.jsx(p,{type:"dashed",icon:e.jsx($,{}),onClick:l,style:{width:"100%",height:"52px",borderRadius:"12px",borderColor:"#6366f1",color:"#6366f1",fontSize:"14px",fontWeight:600,background:"linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%)",border:"2px dashed #6366f1",transition:"all 0.3s ease"},onMouseEnter:t=>{t.currentTarget.style.background="linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%)",t.currentTarget.style.transform="translateY(-1px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(99, 102, 241, 0.2)"},onMouseLeave:t=>{t.currentTarget.style.background="linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%)",t.currentTarget.style.transform="translateY(0px)",t.currentTarget.style.boxShadow="none"},children:"Yangi bo'lim qo'shish"})]})]})]})}const{Title:O}=R,{Content:se}=y;function ne({onSubmit:a,onCancel:h,initialData:m}){const[r,l]=u.useState(0),[s,t]=u.useState(m||{title:"",type:"READING",ieltsId:"",parts:[{number:1,title:"",sections:[]}]}),o=[{title:"Asosiy Ma'lumot",status:r>0?"finish":"process"},{title:"Savollar",status:r===1?"process":"wait"}],{data:d,isLoading:f}=Z(),b=(n,c)=>{const g=[...s.parts];g[n]=c,t({...s,parts:g})},j=()=>{const n={number:s.parts.length+1,title:"",sections:[]};t({...s,parts:[...s.parts,n]})},S=n=>{const c=s.parts.filter((g,v)=>v!==n);t({...s,parts:c})},I=()=>{a(s)},k=()=>r===0?e.jsxs(w,{style:{border:"none",boxShadow:"none"},children:[e.jsx(O,{level:4,style:{marginBottom:"24px"},children:"📋 Asosiy Ma'lumotlar"}),e.jsxs(q,{gutter:[24,24],children:[e.jsxs(T,{span:12,children:[e.jsx("label",{children:"Test nomi"}),e.jsx(A,{placeholder:"Test nomini kiriting",value:s.title,onChange:n=>t({...s,title:n.target.value}),size:"large"})]}),e.jsxs(T,{span:12,children:[e.jsx("label",{children:"IELTS ID"}),e.jsx(E,{placeholder:"IELTS testni tanlang",value:s.ieltsId,onChange:n=>t({...s,ieltsId:n}),size:"large",style:{width:"100%"},loading:f,children:d?.data?.map(n=>e.jsx(E.Option,{value:n.id,children:n.title},n.id))})]})]})]}):e.jsxs("div",{children:[e.jsx(O,{level:4,style:{marginBottom:"24px"},children:"❓ Savollar"}),s.parts.map((n,c)=>e.jsx(te,{part:n,onChange:g=>b(c,g),onRemove:()=>S(c)},c)),e.jsx(p,{type:"dashed",onClick:j,style:{width:"100%",marginTop:16,height:"48px",borderRadius:"8px",borderStyle:"dashed",borderColor:"#10b981"},children:"➕ Yangi Part Qo'shish"})]});return e.jsxs(y,{style:{background:"transparent",minHeight:"80vh"},children:[e.jsx("div",{style:{padding:"16px 24px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(p,{type:"text",icon:e.jsx(M,{}),onClick:()=>{r>0?l(r-1):h()},children:r>0?"Oldingi qadam":"Orqaga"}),e.jsx(D,{current:r,size:"small",style:{flex:1,maxWidth:"600px",margin:"0 40px"},children:o.map((n,c)=>e.jsx(D.Step,{title:n.title,status:n.status},c))}),e.jsxs(z,{children:[r>0&&e.jsx(p,{icon:e.jsx(M,{}),onClick:()=>l(r-1),style:{borderRadius:"6px"},children:"Orqaga"}),r<1?e.jsx(p,{type:"primary",icon:e.jsx(V,{}),onClick:()=>l(r+1),disabled:!s.title||!s.ieltsId,className:"text-white",style:{background:"#10b981",borderColor:"#10b981",borderRadius:"6px"},children:"Keyingi"}):e.jsx(p,{type:"primary",icon:e.jsx(N,{}),onClick:I,style:{background:"#10b981",borderColor:"#10b981",borderRadius:"6px"},children:"Saqlash"})]})]})}),e.jsx(y,{children:e.jsx(se,{style:{padding:"24px",background:"transparent"},children:k()})})]})}const{Title:ie}=R,{Content:ae}=y;function he(){const[a,h]=u.useState(1),[m]=u.useState(10),[r,l]=u.useState(!1),[s,t]=u.useState(null),[o,d]=u.useState(!1),[f,b]=u.useState(null),{data:j,isLoading:S}=U(a,m,"READING"),I=_(),k=H(),n=K(),c=i=>{t(i),l(!0)},g=i=>{b(i),d(!0)},v=(j?.data||[]).filter(i=>i.type==="READING"),F=i=>{const x={...i,parts:i.parts.map((C,G)=>({...C,audioUrl:"",number:G+1}))};s?k.mutate({id:s.id,...x}):I.mutate(x),l(!1),t(null)},Y=[{title:"Test nomi",dataIndex:"title",key:"title",render:i=>e.jsx("span",{style:{fontWeight:500},children:i})},{title:"Turi",dataIndex:"type",key:"type",render:i=>e.jsx("span",{children:i})},{title:"IELTS ID",dataIndex:"ieltsId",key:"ieltsId",render:i=>e.jsx("code",{children:i})},{title:"Amallar",key:"actions",render:(i,x)=>e.jsxs(z,{children:[e.jsx(p,{type:"text",icon:e.jsx(W,{}),onClick:()=>c(x),style:{color:"#1890ff"},children:"Tahrirlash"}),e.jsx(p,{type:"text",danger:!0,icon:e.jsx(P,{}),onClick:()=>g(x.id),children:"O'chirish"})]})}];return e.jsx(y,{children:e.jsxs(ae,{children:[e.jsxs(w,{style:{borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.06)",border:"none"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx(ie,{level:3,children:"📖 Reading Testlar"}),e.jsx(p,{type:"primary",icon:e.jsx($,{}),size:"large",style:{borderRadius:"8px",borderColor:"#10b981",height:"44px",paddingLeft:"20px",paddingRight:"20px"},onClick:()=>{t(null),l(!0)},children:"Yangi Reading Yaratish"})]}),e.jsx(X,{rowKey:"id",loading:S,dataSource:v,columns:Y,pagination:{current:a,pageSize:m,total:j?.total||0,onChange:h,showSizeChanger:!1,showQuickJumper:!0,showTotal:(i,x)=>`${x[0]}-${x[1]} / ${i} ta test`}})]}),e.jsx(B,{open:o,title:"Ishonchingiz komilmi?",onCancel:()=>d(!1),onOk:()=>{f&&n.mutate(f,{onSuccess:()=>{d(!1),b(null)}})},okText:"Ha, o'chirish",cancelText:"Bekor qilish",children:e.jsx("p",{children:"Bu amalni bekor qilib bo'lmaydi."})}),e.jsx(B,{title:null,open:r,onCancel:()=>l(!1),footer:null,width:1400,style:{top:20},bodyStyle:{padding:0},children:e.jsx(ne,{initialData:s?{title:s.title,type:s.type,ieltsId:s.ieltsId,parts:s.parts.map(({number:i,title:x,sections:C})=>({number:i,title:x,sections:C}))}:void 0,onSubmit:F,onCancel:()=>l(!1)})})]})})}export{he as default};

import{az as j,aA as f,aC as y,aB as m,aE as r,j as e,B as g,r as c,L as C,T as L,M as S,a as $}from"./index-uUpZomyQ.js";import{u as B,b as q,C as O,a as D,F as K,S as Q,R as A}from"./Table-XGYKetWf.js";import{u as Y}from"./Ielts-query-BGPdEFI_.js";import{F as i}from"./index-BGInF3ZI.js";import{I as u}from"./index-VUfoB9ds.js";import"./row-B70nMuzF.js";const G=(t=1,a=10)=>B({queryKey:[r.all,t],queryFn:async()=>{const{data:n}=await y.get(`${r.all}?page=${t}&limit=${a}`);return n}}),P=()=>{const t=j();return f({mutationFn:async a=>(await y.post(r.all,a)).data,onSuccess:()=>{t.invalidateQueries({queryKey:[r.all]}),m.success({message:"Writing Test muvaffaqiyatli yaratildi",placement:"bottomRight"})},onError:()=>{m.error({message:"Writing Test yaratishda xatolik yuz berdi",placement:"bottomRight"})}})},H=()=>{const t=j();return f({mutationFn:async({id:a,...n})=>(await y.patch(r.one(a),n)).data,onSuccess:()=>{t.invalidateQueries({queryKey:[r.all]}),m.success({message:"Writing Test muvaffaqiyatli yangilandi",placement:"bottomRight"})},onError:()=>{m.error({message:"Writing Test yangilashda xatolik yuz berdi",placement:"bottomRight"})}})},J=()=>{const t=j();return f({mutationFn:async a=>(await y.delete(r.one(a))).data,onSuccess:()=>{t.invalidateQueries({queryKey:[r.all]}),m.success({message:"Writing Test muvaffaqiyatli o'chirildi",placement:"bottomRight"})},onError:()=>{m.error({message:"Writing Test o'chirishda xatolik yuz berdi",placement:"bottomRight"})}})};function U({initialValues:t,onSubmit:a,onCancel:n}){const[p]=i.useForm(),{data:l,isLoading:d}=Y(),h=o=>{a(o),p.resetFields()};return e.jsxs(i,{layout:"vertical",form:p,onFinish:h,initialValues:t,children:[e.jsx(i.Item,{name:"title",label:"Test nomi",rules:[{required:!0}],children:e.jsx(u,{})}),e.jsx(i.Item,{name:"task1Title",label:"Task 1 sarlavhasi",rules:[{required:!0}],children:e.jsx(u,{})}),e.jsx(i.Item,{name:"task1",label:"Task 1 matni",rules:[{required:!0}],children:e.jsx(u.TextArea,{rows:2})}),e.jsx(i.Item,{name:"task2Title",label:"Task 2 sarlavhasi",rules:[{required:!0}],children:e.jsx(u,{})}),e.jsx(i.Item,{name:"task2",label:"Task 2 matni",rules:[{required:!0}],children:e.jsx(u.TextArea,{rows:2})}),e.jsx(i.Item,{name:"instruction",label:"Ko‘rsatma",rules:[{required:!0}],children:e.jsx(u.TextArea,{rows:2})}),e.jsx(i.Item,{name:"ieltsId",label:"IELTS ID",rules:[{required:!0}],children:e.jsx(q,{placeholder:"IELTS testni tanlang",size:"large",style:{width:"100%"},loading:d,children:l?.data?.map(o=>e.jsx(q.Option,{value:o.id,children:o.title},o.id))})}),e.jsxs("div",{style:{display:"flex",justifyContent:"end",gap:8},children:[e.jsx(g,{onClick:n,children:"Bekor qilish"}),e.jsx(g,{type:"primary",htmlType:"submit",children:"Saqlash"})]})]})}const{Title:V}=L,{Content:_}=C;function se(){const[t,a]=c.useState(1),[n]=c.useState(10),[p,l]=c.useState(!1),[d,h]=c.useState(null),[o,T]=c.useState(!1),[k,b]=c.useState(null),{data:I,isLoading:w}=G(t,n),v=P(),W=H(),R=J(),F=s=>{d?W.mutate({id:d.id,...s}):v.mutate(s),l(!1),h(null)},E=s=>{h(s),l(!0)},M=s=>{b(s),T(!0)},z=[{title:"Test nomi",dataIndex:"title",key:"title"},{title:"Task 1 sarlavha",dataIndex:"task1Title",key:"task1Title"},{title:"Task 2 sarlavha",dataIndex:"task2Title",key:"task2Title"},{title:"IELTS ID",dataIndex:"ieltsId",key:"ieltsId",render:s=>e.jsx("code",{children:s})},{title:"Amallar",key:"actions",render:(s,x)=>e.jsxs(Q,{children:[e.jsx(g,{type:"text",icon:e.jsx($,{}),onClick:()=>E(x),style:{color:"#1890ff"},children:"Tahrirlash"}),e.jsx(g,{type:"text",danger:!0,icon:e.jsx(A,{}),onClick:()=>M(x.id),children:"O'chirish"})]})}];return e.jsx(C,{children:e.jsxs(_,{children:[e.jsxs(O,{style:{borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.06)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsx(V,{level:3,children:"📝 Writing Testlar"}),e.jsx(g,{type:"primary",icon:e.jsx(D,{}),size:"large",style:{borderRadius:"8px",borderColor:"#10b981",height:"44px",paddingLeft:"20px",paddingRight:"20px"},onClick:()=>{h(null),l(!0)},children:"Yangi Writing Yaratish"})]}),e.jsx(K,{rowKey:"id",loading:w,dataSource:I?.data||[],columns:z,pagination:{current:t,pageSize:n,total:I?.total||0,onChange:a,showSizeChanger:!1,showQuickJumper:!0,showTotal:(s,x)=>`${x[0]}-${x[1]} / ${s} ta writing`}})]}),e.jsx(S,{open:o,title:"Ishonchingiz komilmi?",onCancel:()=>T(!1),onOk:()=>{k&&R.mutate(k,{onSuccess:()=>{T(!1),b(null)}})},okText:"Ha, o'chirish",cancelText:"Bekor qilish",children:e.jsx("p",{children:"Bu amalni bekor qilib bo‘lmaydi."})}),e.jsx(S,{open:p,footer:null,title:d?"Writing Testni tahrirlash":"Yangi Writing Test",onCancel:()=>l(!1),width:800,children:e.jsx(U,{initialValues:d||void 0,onSubmit:F,onCancel:()=>l(!1)})})]})})}export{se as default};
